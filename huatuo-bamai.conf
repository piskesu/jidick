# log-level: Debug, Info, Warn, Error, Panic
LogLevel = "Info"
# logging filepath
# LogFile = ""

# the blacklist for tracing and metrics
Blacklist = ["softlockup", "ethtool"]

[RuntimeCgroup]
    LimitInitCPU = 0.5
    LimitCPU = 2.0
    # limit memory (MB)
    LimitMem = 2048

# storage configurations
[Storage]
    # disable ES storage if one of Address, Username, Password empty.
    [Storage.ES]
        Address = "http://127.0.0.1:9200"
        Username = "elastic"
        Password = "huatuo-bamai"
        Index = "huatuo_bamai"

    # tracer's record data
    # Path: all but the last element of path for per tracer
    # RotationSize: the maximum size in Megabytes of a record file before it gets rotated for per subsystem
    # MaxRotation: the maximum number of old log files to retain for per subsystem
    [Storage.LocalFile]
        Path = "./record"
        RotationSize = 100
        MaxRotation = 10

[Tracing]
    [Tracing.Cpuidle]
        CgUserth = 75  #75%
        CgDeltaUserth = 30  #30%
        CgSysth = 45  #45%
        CgDeltaSysth = 0  #0
        CgUsageth = 90 #90%
        CgDeltaUsageth = 30 #30%
        CgStep = 10  #10s
        CgGrace = 1800  #1800s
        CgUsageToolduration = 10  #10s
    [Tracing.Cpusys]
        CPUSysth = 50  #50%
        CPUSysDelta = 30  #30%
        CPUSysStep = 1  #1s
        CPUSysToolduration = 10  #10s
    [Tracing.Waitrate]
        [Tracing.Waitrate.SpikeThreshold]
            "0" = 50.0
            "101" = 80.0
            "102" = 120.0
            "103" = 170.0
            "1" = 220.0
            "2" = 270.0
            "3" = 320.0
            "4" = 370.0
        [Tracing.Waitrate.SlopeThreshold]
            "0" = 0.05
            "101" = 0.1
            "102" = 0.2
            "103" = 0.3
            "1" = 0.4
            "2" = 0.5
            "3" = 0.6
            "4" = 0.7
        [Tracing.Waitrate.SampleConfig]
            # DataSetCapability * SampleInterval is time capability (in seconds)
            DataSetCapability = 360
            # Seconds
            OnceCaptureTime = 15
            SampleInterval = 5
    [Tracing.Softirq]
        ThresholdTime = 100000000
    [Tracing.Dload]
        ThresholdLoad = 5.0
        MonitorGap = 180
    [Tracing.IOTracing]
        IOScheduleThreshold = 100  #100ms
        ReadThreshold = 2000  #MB/s
        WriteThreshold = 1500 #MB/s
        IOutilThreshold = 90  #90%
        IOwaitThreshold = 100 #100ms
        PeriodSecond = 8
        MaxStackNumber = 16
        TopProcessCount = 15
        TopFilesPerProcess = 10
    [Tracing.MemoryReclaim]
        Deltath = 900000000  #900ms
    [Tracing.MemoryBurst]
        HistoryWindowLength = 60
        SampleInterval = 5 # seconds
        SilencePeriod = 300 # seconds
        TopNProcesses = 10
        BurstRatio = 2.0
        AnonThreshold = 70 # percent
    # the latency threshold for package receive
    [Tracing.NetRecvLat]
        ToNetIf = 5 # ms, from driver to a core recv
        ToTCPV4 = 10 # ms, from driver to TCP recv, contains ToNetIf
        ToUserCopy = 115 # ms, from driver to user recv, contains ToNetIf + ToUserCopy
        IgnoreHost = true # whether to ignore the host process
        IgnoreContainerLevel = [103, 3, 4]
    [Tracing.Dropwatch]
        IgnoreNeighInvalidate = true # ignore the error of `neigh_invalidate`
    [Tracing.Netdev]
        Whitelist = ["eth0", "eth1", "bond4", "lo"]
    [Tracing.Fastfork]
        RedisInfoCollectionInterval = 3600 # interval (seconds) of redis proess information collection
        EnableForkProbe = 1 # enable fork kprobe and kretprobe
        EnablePtsepProbe = 1
        EnableWaitptsepProbe = 1

# Collector Configurations.
[MetricCollector]
    # Netdev Configurations.
    [MetricCollector.Netdev]
        # Use `netlink` instead of `procfs net/dev` to get netdev statistic.
        # Only support the host environment to use `netlink` now!
        EnableNetlink = false
        # IgnoredDevices: Ignore special devices in this netdev statistic.
        # AcceptDevices: Accept special devices in this netdev statistic.
        # These configurations use `Regexp`.
        # 'IgnoredDevices' has higher priority than 'AcceptDevices'.
        IgnoredDevices = "^(lo)|(docker\\w*)|(veth\\w*)$"
        #AcceptDevices = ""
    # Qdisc Configurations.
    [MetricCollector.Qdisc]
        # IgnoredDevices: Ignore special devices in this qdisc statistic.
        # AcceptDevices: Accept special devices in this qdisc statistic.
        # These configurations use `Regexp`.
        # 'IgnoredDevices' has higher priority than 'AcceptDevices'.
        IgnoredDevices = "^(lo)|(docker\\w*)|(veth\\w*)$"
        #AcceptDevices = ""
    [MetricCollector.Vmstat]
        IncludedMetrics = "allocstall|nr_active_anon|nr_active_file|nr_boost_pages|nr_dirty|nr_free_pages|nr_inactive_anon|nr_inactive_file|nr_kswapd_boost|nr_mlock|nr_shmem|nr_slab_reclaimable|nr_slab_unreclaimable|nr_unevictable|nr_writeback|numa_pages_migrated|pgdeactivate|pgrefill|pgscan_direct|pgscan_kswapd|pgsteal_direct|pgsteal_kswapd"
        ExcludedMetrics = "total"
    [MetricCollector.MemoryStat]
        IncludedMetrics = "active_anon|active_file|dirty|inactive_anon|inactive_file|pgdeactivate|pgrefill|pgscan_direct|pgscan_kswapd|pgsteal_direct|pgsteal_kswapd|shmem|unevictable|writeback|pgscan_globaldirect|pgscan_globalkswapd|pgscan_cswapd|pgsteal_cswapd|pgsteal_globaldirect|pgsteal_globalkswapd"
        ExcludedMetrics = "total"
    [MetricCollector.MemoryEvents]
        IncludedMetrics = "watermark_inc|watermark_dec"
        # ExcludedMetrics = ""
    [MetricCollector.Netstat]
        # ExcludedMetrics: Ignore keys in this netstat statistic.
        # IncludedMetrics: Accept keys in this netstat statistic.
        # The 'key' format: protocol + '_' + netstat_name. eg: TcpExt_TCPSynRetrans.
        # These configurations use `Regexp`.
        # 'ExcludedMetrics' has higher priority than 'IncludedMetrics'.
        #ExcludedMetrics = ""
        #IncludedMetrics = ""
    [MetricCollector.MountPointStat]
        IncludedMountPoints = "(^/home$)|(^/$)|(^/boot$)"
